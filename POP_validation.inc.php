<?php
//*****************************************************************************
//*****************************************************************************
/**
* Validation Functions Plugin
*
* @package		phpOpenPlugins
* @subpackage	Validation
* @author 		Christian J. Clark
* @copyright	Copyright (c) Christian J. Clark
* @license		http://www.gnu.org/licenses/gpl-2.0.txt
* @link			http://www.emonlade.net/phpopenplugins/
* @version 		Started: 7/17/2012, Last updated: 7/17/2012
**/
//*****************************************************************************
//*****************************************************************************

//=============================================================================
//=============================================================================
// Check and Clear Form Key Function
//=============================================================================
//=============================================================================
function check_and_clear_form_key($obj, $mod_var_index, $form_key)
{
	$do_trans = false;
	$form_key_sess = $obj->get_mod_var($mod_var_index);
	if (isset($form_key) && $form_key_sess && $form_key && $form_key == $form_key_sess) {
		$do_trans = true;
		$obj->clear_mod_var($mod_var_index);
	}
	return $do_trans;
}

//=============================================================================
//=============================================================================
// Is Valid User ID Function
//=============================================================================
//=============================================================================
function is_valid_userid($userid)
{
	$userid_regex = '/^[a-z\d_]{4,28}$/i';
	return (preg_match($userid_regex, $userid)) ? (1) : (0);
}

//=============================================================================
//=============================================================================
// Is Function Function :)
//=============================================================================
//=============================================================================
if (!function_exists('is_function')) {
	function is_function($f)
	{
		return (gettype($f) == 'object') ? (true) : (false);
	}
}

?>
